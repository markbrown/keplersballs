(()=>{"use strict";var t,i,e,s,n={208:(t,i,e)=>{e.d(i,{A:()=>f});var s=e(354),n=e.n(s),o=e(314),r=e.n(o),h=e(417),a=e.n(h),l=new URL(e(54),e.b),p=new URL(e(215),e.b),c=r()(n()),u=a()(l),d=a()(p);c.push([t.id,`@font-face {\n    font-family: "Philosopher";\n    src: url(${u});\n}\n\n@font-face {\n    font-family: "League Spartan";\n    src: url(${d});\n}\n\nbody {\n    margin: 0;\n    direction: ltr;\n    user-select: none;\n}\n\n#container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    overflow-x: hidden;\n    background: #222;\n    align-items: center;\n}\n\n#canvas {\n    height: 100vh;\n    min-height: 720px;\n}\n\n#overlay {\n    position: absolute;\n    height: 100vh;\n    min-height: 720px;\n    width: 100vw;\n    max-width: max(177.78vh, 1280px);\n    font-family: Philosopher, sans-serif;\n    color: #bbb;\n}\n\n#buttons {\n    position: absolute;\n    display: flex;\n    flex-direction: row;\n    column-gap: 16px;\n    justify-content: right;\n    height: 32px;\n    top: 16px;\n    left: 16px;\n    right: 16px;\n    font-size: 18pt;\n}\n\n#buttons > * {\n    margin: auto 0;\n}\n\n#buttons .message {\n    visibility: hidden;\n}\n\n#confirm {\n    margin-right: auto;\n}\n\n#confirm.highlight > * {\n    color: lime;\n    border-color: lime;\n    visibility: visible;\n}\n\nlabel {\n    padding-right: .5ex;\n}\n\nbutton, select {\n    background: transparent;\n    color: white;\n    padding-bottom: 1.5px;\n    border: solid white 1px;\n    border-radius: 4px;\n    font: 18pt Philosopher, sans-serif;\n}\n\nselect>option {\n    background: black;\n}\n\n#help {\n    position: absolute;\n    top: 25%;\n    height: 50%;\n    width: 100%;\n    background: transparent;\n}\n\n#help > * {\n    position: absolute;\n    top: 0;\n    width: 450px;\n    height: 100%;\n}\n\n#commands {\n    left: calc(50% + 140px);\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    row-gap: 16px;\n    font-size: 24pt;\n}\n\n#commands > * {\n    display: flex;\n}\n\n#commands > * > :first-child {\n    width: 300px;\n}\n\n#commands > * > :last-child {\n    margin: auto;\n}\n\n#about-container {\n    overflow: hidden;\n    right: calc(50% + 128px);\n}\n\n#about {\n    margin-top: 1000px;\n    font: 16pt Philosopher, sans-serif;\n}\n\n#about > :first-child {\n    margin-top: 0;\n}\n\n#about > h2 {\n    color: #ddd;\n}\n`,"",{version:3,sources:["webpack://./src/style.css"],names:[],mappings:"AAAA;IACI,0BAA0B;IAC1B,4CAA4C;AAChD;;AAEA;IACI,6BAA6B;IAC7B,4CAA8C;AAClD;;AAEA;IACI,SAAS;IACT,cAAc;IACd,iBAAiB;AACrB;;AAEA;IACI,kBAAkB;IAClB,aAAa;IACb,sBAAsB;IACtB,kBAAkB;IAClB,gBAAgB;IAChB,mBAAmB;AACvB;;AAEA;IACI,aAAa;IACb,iBAAiB;AACrB;;AAEA;IACI,kBAAkB;IAClB,aAAa;IACb,iBAAiB;IACjB,YAAY;IACZ,gCAAgC;IAChC,oCAAoC;IACpC,WAAW;AACf;;AAEA;IACI,kBAAkB;IAClB,aAAa;IACb,mBAAmB;IACnB,gBAAgB;IAChB,sBAAsB;IACtB,YAAY;IACZ,SAAS;IACT,UAAU;IACV,WAAW;IACX,eAAe;AACnB;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI,WAAW;IACX,kBAAkB;IAClB,mBAAmB;AACvB;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,uBAAuB;IACvB,YAAY;IACZ,qBAAqB;IACrB,uBAAuB;IACvB,kBAAkB;IAClB,kCAAkC;AACtC;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,kBAAkB;IAClB,QAAQ;IACR,WAAW;IACX,WAAW;IACX,uBAAuB;AAC3B;;AAEA;IACI,kBAAkB;IAClB,MAAM;IACN,YAAY;IACZ,YAAY;AAChB;;AAEA;IACI,uBAAuB;IACvB,aAAa;IACb,sBAAsB;IACtB,uBAAuB;IACvB,aAAa;IACb,eAAe;AACnB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,YAAY;AAChB;;AAEA;IACI,gBAAgB;IAChB,wBAAwB;AAC5B;;AAEA;IACI,kBAAkB;IAClB,kCAAkC;AACtC;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,WAAW;AACf",sourcesContent:['@font-face {\n    font-family: "Philosopher";\n    src: url("../fonts/Philosopher-Regular.ttf");\n}\n\n@font-face {\n    font-family: "League Spartan";\n    src: url("../fonts/LeagueSpartan-Regular.ttf");\n}\n\nbody {\n    margin: 0;\n    direction: ltr;\n    user-select: none;\n}\n\n#container {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    overflow-x: hidden;\n    background: #222;\n    align-items: center;\n}\n\n#canvas {\n    height: 100vh;\n    min-height: 720px;\n}\n\n#overlay {\n    position: absolute;\n    height: 100vh;\n    min-height: 720px;\n    width: 100vw;\n    max-width: max(177.78vh, 1280px);\n    font-family: Philosopher, sans-serif;\n    color: #bbb;\n}\n\n#buttons {\n    position: absolute;\n    display: flex;\n    flex-direction: row;\n    column-gap: 16px;\n    justify-content: right;\n    height: 32px;\n    top: 16px;\n    left: 16px;\n    right: 16px;\n    font-size: 18pt;\n}\n\n#buttons > * {\n    margin: auto 0;\n}\n\n#buttons .message {\n    visibility: hidden;\n}\n\n#confirm {\n    margin-right: auto;\n}\n\n#confirm.highlight > * {\n    color: lime;\n    border-color: lime;\n    visibility: visible;\n}\n\nlabel {\n    padding-right: .5ex;\n}\n\nbutton, select {\n    background: transparent;\n    color: white;\n    padding-bottom: 1.5px;\n    border: solid white 1px;\n    border-radius: 4px;\n    font: 18pt Philosopher, sans-serif;\n}\n\nselect>option {\n    background: black;\n}\n\n#help {\n    position: absolute;\n    top: 25%;\n    height: 50%;\n    width: 100%;\n    background: transparent;\n}\n\n#help > * {\n    position: absolute;\n    top: 0;\n    width: 450px;\n    height: 100%;\n}\n\n#commands {\n    left: calc(50% + 140px);\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    row-gap: 16px;\n    font-size: 24pt;\n}\n\n#commands > * {\n    display: flex;\n}\n\n#commands > * > :first-child {\n    width: 300px;\n}\n\n#commands > * > :last-child {\n    margin: auto;\n}\n\n#about-container {\n    overflow: hidden;\n    right: calc(50% + 128px);\n}\n\n#about {\n    margin-top: 1000px;\n    font: 16pt Philosopher, sans-serif;\n}\n\n#about > :first-child {\n    margin-top: 0;\n}\n\n#about > h2 {\n    color: #ddd;\n}\n'],sourceRoot:""}]);const f=c},314:t=>{t.exports=function(t){var i=[];return i.toString=function(){return this.map((function(i){var e="",s=void 0!==i[5];return i[4]&&(e+="@supports (".concat(i[4],") {")),i[2]&&(e+="@media ".concat(i[2]," {")),s&&(e+="@layer".concat(i[5].length>0?" ".concat(i[5]):""," {")),e+=t(i),s&&(e+="}"),i[2]&&(e+="}"),i[4]&&(e+="}"),e})).join("")},i.i=function(t,e,s,n,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(s)for(var h=0;h<this.length;h++){var a=this[h][0];null!=a&&(r[a]=!0)}for(var l=0;l<t.length;l++){var p=[].concat(t[l]);s&&r[p[0]]||(void 0!==o&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=o),e&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=e):p[2]=e),n&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=n):p[4]="".concat(n)),i.push(p))}},i}},417:t=>{t.exports=function(t,i){return i||(i={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),i.hash&&(t+=i.hash),/["'() \t\n]|(%20)/.test(t)||i.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},354:t=>{t.exports=function(t){var i=t[1],e=t[3];if(!e)return i;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),o="/*# ".concat(n," */");return[i].concat([o]).join("\n")}return[i].join("\n")}},72:t=>{var i=[];function e(t){for(var e=-1,s=0;s<i.length;s++)if(i[s].identifier===t){e=s;break}return e}function s(t,s){for(var o={},r=[],h=0;h<t.length;h++){var a=t[h],l=s.base?a[0]+s.base:a[0],p=o[l]||0,c="".concat(l," ").concat(p);o[l]=p+1;var u=e(c),d={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==u)i[u].references++,i[u].updater(d);else{var f=n(d,s);s.byIndex=h,i.splice(h,0,{identifier:c,updater:f,references:1})}r.push(c)}return r}function n(t,i){var e=i.domAPI(i);return e.update(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap&&i.supports===t.supports&&i.layer===t.layer)return;e.update(t=i)}else e.remove()}}t.exports=function(t,n){var o=s(t=t||[],n=n||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var h=e(o[r]);i[h].references--}for(var a=s(t,n),l=0;l<o.length;l++){var p=e(o[l]);0===i[p].references&&(i[p].updater(),i.splice(p,1))}o=a}}},659:t=>{var i={};t.exports=function(t,e){var s=function(t){if(void 0===i[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}i[t]=e}return i[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}},540:t=>{t.exports=function(t){var i=document.createElement("style");return t.setAttributes(i,t.attributes),t.insert(i,t.options),i}},56:(t,i,e)=>{t.exports=function(t){var i=e.nc;i&&t.setAttribute("nonce",i)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var i=t.insertStyleElement(t);return{update:function(e){!function(t,i,e){var s="";e.supports&&(s+="@supports (".concat(e.supports,") {")),e.media&&(s+="@media ".concat(e.media," {"));var n=void 0!==e.layer;n&&(s+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),s+=e.css,n&&(s+="}"),e.media&&(s+="}"),e.supports&&(s+="}");var o=e.sourceMap;o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),i.styleTagTransform(s,t,i.options)}(i,t,e)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)}}}},113:t=>{t.exports=function(t,i){if(i.styleSheet)i.styleSheet.cssText=t;else{for(;i.firstChild;)i.removeChild(i.firstChild);i.appendChild(document.createTextNode(t))}}},215:(t,i,e)=>{t.exports=e.p+"09958bb07a94a6a4f1bb.ttf"},54:(t,i,e)=>{t.exports=e.p+"b560e688d74fde752890.ttf"}},o={};function r(t){var i=o[t];if(void 0!==i)return i.exports;var e=o[t]={id:t,exports:{}};return n[t](e,e.exports,r),e.exports}r.m=n,r.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return r.d(i,{a:i}),i},i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(e,s){if(1&s&&(e=this(e)),8&s)return e;if("object"==typeof e&&e){if(4&s&&e.__esModule)return e;if(16&s&&"function"==typeof e.then)return e}var n=Object.create(null);r.r(n);var o={};t=t||[null,i({}),i([]),i(i)];for(var h=2&s&&e;"object"==typeof h&&!~t.indexOf(h);h=i(h))Object.getOwnPropertyNames(h).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,r.d(n,o),n},r.d=(t,i)=>{for(var e in i)r.o(i,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((i,e)=>(r.f[e](t,i),i)),[])),r.u=t=>t+".bundle.js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),e={},s="keplersballs:",r.l=(t,i,n,o)=>{if(e[t])e[t].push(i);else{var h,a;if(void 0!==n)for(var l=document.getElementsByTagName("script"),p=0;p<l.length;p++){var c=l[p];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==s+n){h=c;break}}h||(a=!0,(h=document.createElement("script")).charset="utf-8",h.timeout=120,r.nc&&h.setAttribute("nonce",r.nc),h.setAttribute("data-webpack",s+n),h.src=t),e[t]=[i];var u=(i,s)=>{h.onerror=h.onload=null,clearTimeout(d);var n=e[t];if(delete e[t],h.parentNode&&h.parentNode.removeChild(h),n&&n.forEach((t=>t(s))),i)return i(s)},d=setTimeout(u.bind(null,void 0,{type:"timeout",target:h}),12e4);h.onerror=u.bind(null,h.onerror),h.onload=u.bind(null,h.onload),a&&document.head.appendChild(h)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var i=r.g.document;if(!t&&i&&(i.currentScript&&"SCRIPT"===i.currentScript.tagName.toUpperCase()&&(t=i.currentScript.src),!t)){var e=i.getElementsByTagName("script");if(e.length)for(var s=e.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=e[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{r.b=document.baseURI||self.location.href;var t={792:0};r.f.j=(i,e)=>{var s=r.o(t,i)?t[i]:void 0;if(0!==s)if(s)e.push(s[2]);else{var n=new Promise(((e,n)=>s=t[i]=[e,n]));e.push(s[2]=n);var o=r.p+r.u(i),h=new Error;r.l(o,(e=>{if(r.o(t,i)&&(0!==(s=t[i])&&(t[i]=void 0),s)){var n=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;h.message="Loading chunk "+i+" failed.\n("+n+": "+o+")",h.name="ChunkLoadError",h.type=n,h.request=o,s[1](h)}}),"chunk-"+i,i)}};var i=(i,e)=>{var s,n,[o,h,a]=e,l=0;if(o.some((i=>0!==t[i]))){for(s in h)r.o(h,s)&&(r.m[s]=h[s]);a&&a(r)}for(i&&i(e);l<o.length;l++)n=o[l],r.o(t,n)&&t[n]&&t[n][0](),t[n]=0},e=self.webpackChunkkeplersballs=self.webpackChunkkeplersballs||[];e.forEach(i.bind(null,0)),e.push=i.bind(null,e.push.bind(e))})(),r.nc=void 0;var h=r(72),a=r.n(h),l=r(825),p=r.n(l),c=r(659),u=r.n(c),d=r(56),f=r.n(d),A=r(540),m=r.n(A),y=r(113),g=r.n(y),E=r(208),b={};b.styleTagTransform=g(),b.setAttributes=f(),b.insert=u().bind(null,"head"),b.domAPI=p(),b.insertStyleElement=m(),a()(E.A,b),E.A&&E.A.locals&&E.A.locals;const I=2*Math.PI;function T(t=0,i=0){if(!new.target)return new T(t,i);this.x=t,this.y=i}T.fuzz=function(t){return T.polar(t*Math.random(),I*Math.random())},T.polar=function(t,i){return T(t*Math.cos(i),t*Math.sin(i))},T.prototype.plus=function(t){return T(this.x+t.x,this.y+t.y)},T.prototype.minus=function(t){return T(this.x-t.x,this.y-t.y)},T.prototype.scale=function(t){return T(this.x*t,this.y*t)},T.prototype.descale=function(t){return T(this.x/t,this.y/t)},T.prototype.unit=function(){return this.descale(this.len())},T.prototype.len=function(){return Math.sqrt(this.sqr())},T.prototype.sqr=function(){return this.dot(this)},T.prototype.dot=function(t){return this.x*t.x+this.y*t.y},T.prototype.cross2d=function(t){return this.x*t.y-this.y*t.x},T.prototype.crossZ=function(t){return T(this.y*t,-this.x*t)},T.prototype.rotate=function(t){let i=Math.sin(t),e=Math.cos(t);return T(this.x*e-this.y*i,this.x*i+this.y*e)},T.prototype.theta=function(){let t=Math.atan2(this.y,this.x);return t<0?t+I:t},T.prototype.moveTo=function(t){t.moveTo(this.x,this.y)},T.prototype.lineTo=function(t){t.lineTo(this.x,this.y)},T.prototype.spot=function(t,i,e=null){e&&(t.fillStyle=e),t.beginPath(),t.arc(this.x,this.y,i,0,I),t.fill()},T.prototype.write=function(t,i,e,s=0,n="#fff"){t.save(),t.font=i,t.fillStyle=n,t.translate(this.x,this.y),t.scale(1,-1),t.fillText(e,0,s),t.restore()};const v=2*Math.PI;function C(t,i,e){let s=1+Math.random();this.path=t.copy(),this.color=i,this.radius=e*C.SIZE_FACTOR/s**2,this.age=0,this.life=C.LIFE_MS;let n=s*C.BASE_SPEED;this.path.impulse(T.polar(n,v*Math.random()))}function O(t=T(),i=T()){this.pos=t,this.vel=i}C.LIFE_MS=200,C.BASE_SPEED=250,C.SIZE_FACTOR=.2,C.prototype.alive=function(){return this.age<this.life},C.prototype.advance=function(t,i=null){this.age+=t,i&&this.alive()&&i.push(this)},C.prototype.draw=function(t){this.path.position(this.age).spot(t,this.radius,this.color)},O.prototype.copy=function(){return new O(this.pos,this.vel)},O.prototype.rotate=function(t){this.pos=this.pos.rotate(t),this.vel=this.vel.rotate(t)},O.prototype.position=function(t){return this.pos.plus(this.vel.scale(t/1e3))},O.prototype.altitude=function(){return this.pos.len()},O.prototype.speed=function(){return this.vel.len()},O.prototype.impulse=function(t){this.vel=this.vel.plus(t)},O.prototype.slow=function(t){this.vel=this.vel.descale(t)},O.prototype.cap=function(t){let i=this.speed();i>t&&(this.vel=this.vel.scale(t/i))};const w=2*Math.PI;function S(t,i){this.mu=t,this.path=i,this.periapsis=!1,this.h=i.pos.cross2d(i.vel);let e=i.vel.crossZ(this.h/t).minus(i.pos.unit());this.e=e.len();let s=1-this.e**2;if(this.p=this.h**2/t,this.a=this.p/s,this.b=Math.sign(this.h)*this.p/Math.sqrt(s),this.e<1e-6)this.major=T(this.a,0),this.minor=T(0,this.b);else{let t=e.descale(this.e);this.major=t.scale(this.a),this.minor=t.crossZ(-this.b)}this.center=e.scale(-this.a),this.phi=this.meanAnomaly(i.pos),this.omega=Math.sqrt(t/this.a**3)}function L(t,i,e){this.params=t,this.size=e,this.color=L.colors[Math.floor(Math.random()*L.colors.length)],(i=i.copy()).impulse(T.fuzz(i.speed()*L.FUZZ_FACTOR)),i.cap(Math.sqrt(2*t.mu/i.altitude())*L.SPEED_CAP),this.orbit=new S(t.mu,i);let s=L.info[this.size];this.radius=s.radius;let n=Math.floor(s.varhp*Math.random());this.hp=t.roidBaseHP+s.minhp+n,this.font=`${s.fontsize} ${L.FONT_FAMILY}`,this.offset=s.offset}S.MARKER_SIZE=3,S.ALPHA=80,S.FADEOUT=18,S.prototype.advance=function(t){this.phi+=t*this.omega/1e3,this.phi>=w?(this.phi-=w,this.periapsis=!0):this.phi<0&&(this.phi+=w,this.periapsis=!0),this.get(this.path)},S.prototype.complete=function(){return!!this.periapsis&&(this.periapsis=!1,!0)},S.prototype.get=function(t,i=0){let e=this.meanToEccentric(this.phi+i*this.omega),s=Math.cos(e),n=Math.sin(e),o=this.major.scale(s),r=this.minor.scale(n);t.pos=this.center.plus(o).plus(r);let h=this.major.scale(-n),a=this.minor.scale(s),l=h.plus(a).unit(),p=Math.sqrt(this.mu*(2/t.pos.len()-1/this.a));t.vel=l.scale(p)},S.prototype.meanAnomaly=function(t){let i=this.eccentricAnomaly(t);return this.eccentricToMean(i)},S.prototype.eccentricAnomaly=function(t){let i=t.minus(this.center),e=i.dot(this.major)/this.a**2,s=i.dot(this.minor)/this.b**2,n=Math.atan2(s,e);return n<0?n+w:n},S.prototype.eccentricToMean=function(t){return t-this.e*Math.sin(t)},S.prototype.meanToEccentric=function(t){(t%=w)<0&&(t+=w);let i=0,e=this.e<.8?t:Math.PI,s=e-this.e*Math.sin(t)-t;for(;Math.abs(s)>1e-4&&i<8;)e-=s/(1-this.e*Math.cos(e)),s=this.eccentricToMean(e)-t,i++;return e},S.prototype.draw=function(t){let i=new O,e=0,s=w/this.omega,n=S.ALPHA;for(;n>=1&&++e<s;){this.get(i,e);let s=`rgb(192 192 192 / ${Math.floor(n)}%)`;i.pos.spot(t,S.MARKER_SIZE,s),n-=this.omega*S.FADEOUT}},L.LOSS_FACTOR=.8,L.FUZZ_FACTOR=.15,L.SPEED_CAP=.99,L.DEBRIS=9,L.FONT_FAMILY="'League Spartan', sans-serif",L.colors=["IndianRed","PaleVioletRed","Tomato","Orchid","DarkKhaki","RebeccaPurple","DarkSlateBlue","Purple","Olive","Teal","CadetBlue","CornflowerBlue","RosyBrown","SaddleBrown","Maroon"],L.info=[{radius:12,minhp:5,varhp:8,fontsize:"16pt",offset:1.4},{radius:18,minhp:7,varhp:10,fontsize:"20pt",offset:1.4},{radius:24,minhp:11,varhp:12,fontsize:"24pt",offset:2.2},{radius:30,minhp:14,varhp:12,fontsize:"30pt",offset:2}],L.prototype.pos=function(){return this.orbit.path.pos},L.prototype.vel=function(){return this.orbit.path.vel},L.prototype.advance=function(t,i=null){this.orbit.advance(t),i&&i.push(this)},L.prototype.collide=function(t,i=0){return t.minus(this.pos()).sqr()<(this.radius+i)**2},L.prototype.smash=function(t,i,e,s){if(this.hp>t)return this.hp-=t,i.push(this),0;{s.pop(this.size);for(let t=0;t<L.DEBRIS;t++)e.push(new C(this.orbit.path,this.color,this.radius));let n=1;if(this.size>0){let o=this.params,r=this.size-1,h=this.pos(),a=h.unit().scale(this.radius/3),l=this.vel().scale(L.LOSS_FACTOR),p=new L(o,new O(h.plus(a),l),r),c=new L(o,new O(h.minus(a),l),r),u=t-this.hp,d=Math.floor(u*Math.random()),f=u-d;n+=p.smash(d,i,e,s),n+=c.smash(f,i,e,s)}return n}},L.prototype.draw=function(t){let i=this.pos();i.spot(t,this.radius,this.color),i.write(t,this.font,this.hp,this.offset)};const R=r.p+"e222a9ab3503e923a3e4.mp3",M=r.p+"77da71ad02f230daf33a.mp3",_=r.p+"6532f8b4031c97c06e1f.mp3",k=r.p+"ac1d0bc9fd816fc67818.mp3";function x(){this.ctx=null,this.fxGain=null,this.musicGain=null,this.musicSource=null,this.fx=!0,this.music=!0,this.loaded=!1,this.playing=!0}function B(t,i,e){this.pos=T((t-.5)*(B.WIDTH+B.SEP),B.TITLE_OFFSET),this.x=(t-1)*(B.WIDTH+B.SEP)+B.SEP/2,this.title=i,this.color=e}x.SAMPLE_OFFSET=.5,x.SAMPLE_LENGTH=.4,x.POP_VARIANTS=4,x.prototype.setup=function(){this.ctx=new AudioContext,(async()=>{this.hitBuffer=await this.load(M),this.popBuffer=await this.load(_),this.crashBuffer=await this.load(R),this.winBuffer=await this.load(k);let{default:t}=await r.e(270).then(r.t.bind(r,270,17)),{default:i}=await r.e(729).then(r.t.bind(r,729,17));this.playingBuffer=await this.load(t),this.stoppedBuffer=await this.load(i),this.loaded=!0,this.startMusic()})(),this.fxGain=this.ctx.createGain(),this.fxGain.connect(this.ctx.destination),this.fx||this.disableFx(),this.musicGain=this.ctx.createGain(),this.musicGain.connect(this.ctx.destination),this.music||this.disableMusic()},x.prototype.load=function(t){return fetch(t).then((t=>t.arrayBuffer())).then((t=>this.ctx.decodeAudioData(t)))},x.prototype.enableFx=function(){this.fxGain&&(this.fxGain.gain.value=1),this.fx=!0},x.prototype.disableFx=function(){this.fxGain&&(this.fxGain.gain.value=0),this.fx=!1},x.prototype.enableMusic=function(){this.musicGain&&(this.musicGain.gain.value=1),this.music=!0},x.prototype.disableMusic=function(){this.musicGain&&(this.musicGain.gain.value=0),this.music=!1},x.prototype.startPlaying=function(){this.playing=!0,this.loaded&&this.startMusic()},x.prototype.stopPlaying=function(){this.playing=!1,this.loaded&&this.startMusic()},x.prototype.startMusic=function(){if(!this.loaded)return;this.stopMusic();let t=this.playing?this.playingBuffer:this.stoppedBuffer;this.musicSource=this.ctx.createBufferSource(),this.musicSource.loop=!0,this.musicSource.buffer=t,this.musicSource.connect(this.musicGain),this.musicSource.start()},x.prototype.stopMusic=function(){this.musicSource&&this.musicSource.stop()},x.prototype.hit=function(){this.playSample(this.hitBuffer,0)},x.prototype.pop=function(t){let i=Math.floor(Math.random()*x.POP_VARIANTS)*L.info.length+t;this.playSample(this.popBuffer,i)},x.prototype.crash=function(){this.playBuffer(this.crashBuffer)},x.prototype.win=function(){this.playBuffer(this.winBuffer)},x.prototype.playBuffer=function(t){this.makeSource(t).start()},x.prototype.playSample=function(t,i){this.makeSource(t).start(0,i*x.SAMPLE_OFFSET,x.SAMPLE_LENGTH)},x.prototype.makeSource=function(t){let i=this.ctx.createBufferSource();return i.buffer=t,i.connect(this.fxGain),i},B.SEP=40,B.WIDTH=240,B.HEIGHT=12,B.OFFSET=316,B.TITLE_OFFSET=340,B.TITLE_FONT="16pt Philosopher, sans-serif",B.TITLE_COLOR="#ccc",B.prototype.draw=function(t,i=0){this.pos.write(t,B.TITLE_FONT,this.title,0,B.TITLE_COLOR),t.strokeStyle=this.color,t.fillStyle=this.color,t.strokeRect(this.x,B.OFFSET,B.WIDTH,B.HEIGHT),t.fillRect(this.x,B.OFFSET,i*B.WIDTH,B.HEIGHT)};const P=r.p+"5fdd06a1e31ea469ddd5.svg",N=r.p+"5d6aa3969dfc09e9af97.svg";function F(t){this.game=t,this.container=document.getElementById("container"),this.buttons=document.getElementById("buttons"),this.confirmItem=document.getElementById("confirm"),this.fullscreen=null,this.idleTimer=null,this.ignoreMove=!1,this.confirmReset=!1,this.reload=document.getElementById("reload"),this.reload.addEventListener("click",(()=>this.doReload())),this.reset=document.getElementById("reset"),this.reset.addEventListener("click",(t=>this.doReset(t))),this.difficulty=document.getElementById("difficulty"),this.difficulty.addEventListener("change",(()=>this.difficultyChange())),this.difficulty.addEventListener("focus",(()=>this.hideConfirm())),this.quavers=document.getElementById("quavers"),this.quavers.addEventListener("click",(()=>this.doQuavers())),this.speaker=document.getElementById("speaker"),this.speaker.addEventListener("click",(()=>this.doSpeaker())),document.fullscreenEnabled&&(this.fullscreen=new Image,this.fullscreen.src=P,this.fullscreen.addEventListener("click",(t=>this.doFullscreen())),this.buttons.appendChild(this.fullscreen),document.addEventListener("fullscreenchange",(t=>this.fullscreenChange())),document.addEventListener("mousemove",(()=>this.mousemove())),document.addEventListener("mouseover",(()=>this.mouseover())))}function D(){this.start()}function H(){this.enabled=!1,this.lock=!1,this.reset(),addEventListener("blur",(t=>this.reset())),addEventListener("keydown",(t=>this.keyevent(t.code,!0))),addEventListener("keyup",(t=>this.keyevent(t.code,!1)))}function W(){this.help=document.getElementById("help"),this.about=document.getElementById("about")}function G(t="keplersballs"){this.name=t,this.times={easy:this.read("easy"),medium:this.read("medium"),hard:this.read("hard")},this.setup()}function U(t){this.difficulty=t,this.sunColor="yellow",this.sunRadius=10,this.setup(t),this.mu=1e5*this.sunRadius,this.shipRadius=10*this.sunRadius}F.MOUSE_TIMEOUT=1e3,F.COLOR_ON="#fff",F.COLOR_OFF="#444",F.prototype.mouseover=function(){document.fullscreenElement||(this.container.style.cursor="")},F.prototype.mousemove=function(){this.ignoreMove||document.fullscreenElement&&(this.container.style.cursor="",clearTimeout(this.idleTimer),this.idleTimer=setTimeout((()=>{this.container.style.cursor="none",this.ignoreMove=!0,setTimeout((()=>{this.ignoreMove=!1}),200)}),F.MOUSE_TIMEOUT))},F.prototype.startPlaying=function(){this.reset.style.visibility="hidden",this.difficulty.disabled=!0},F.prototype.stopPlaying=function(){this.reset.style.visibility="visible",this.difficulty.disabled=!1},F.prototype.doReload=function(){this.game.reload()},F.prototype.doReset=function(t){t.stopPropagation(),t.preventDefault(),this.confirmReset?(this.hideConfirm(),this.game.leaders.reset()):this.showConfirm()},F.prototype.showConfirm=function(){this.confirmReset||(this.confirmReset=!0,this.confirmItem.classList.add("highlight"))},F.prototype.hideConfirm=function(){this.confirmReset&&(this.confirmReset=!1,this.confirmItem.classList.remove("highlight"))},F.prototype.doQuavers=function(){this.game.audio.music?(this.game.audio.disableMusic(),this.quavers.style.fill=F.COLOR_OFF):(this.game.audio.enableMusic(),this.quavers.style.fill=F.COLOR_ON)},F.prototype.doSpeaker=function(){this.game.audio.fx?(this.game.audio.disableFx(),this.speaker.style.fill=F.COLOR_OFF):(this.game.audio.enableFx(),this.speaker.style.fill=F.COLOR_ON)},F.prototype.doFullscreen=function(){document.fullscreenElement?document.exitFullscreen():this.container.requestFullscreen()},F.prototype.fullscreenChange=function(){document.fullscreenElement?(this.fullscreen.src=N,this.container.style.cursor="none"):(this.fullscreen.src=P,this.container.style.cursor="")},F.prototype.difficultyChange=function(){this.game.result=null},D.TICK_MS=100,D.MAX_GAME_TIME_PER_FRAME_MS=25,D.format=function(t,i=!1){let e=Math.floor(t/600),s=Math.floor(t/10)%60;return i?`${e}m${s}.${t%10}s`:e>0?`${e}m${s}s`:`${s}s`},D.prototype.start=function(){this.last=Date.now(),this.time=0,this.ticks=0,this.current=""},D.prototype.frame=function(t){let i=Date.now(),e=Math.min(D.MAX_GAME_TIME_PER_FRAME_MS,i-this.last);this.last=Math.max(this.last+e,i-D.TICK_MS);let s=this.time+e;s>this.ticks*D.TICK_MS&&(this.update(t,this.ticks*D.TICK_MS),this.ticks++,this.ticks%10==0&&(this.current=D.format(this.ticks)),t.tick(this.ticks)),this.update(t,s)},D.prototype.update=function(t,i){let e=i-this.time;e>0&&t.update(e),this.time=i},D.prototype.finish=function(t,i){return t.insert(this.ticks,i),t.ordinal()||D.format(this.ticks,!0)},H.prototype.reset=function(){this.arrowUp=!1,this.arrowDown=!1,this.arrowLeft=!1,this.arrowRight=!1,this.keyW=!1,this.keyA=!1,this.keyS=!1,this.keyD=!1,this.numpad2=!1,this.numpad4=!1,this.numpad5=!1,this.numpad6=!1,this.numpad8=!1,this.space=!1},H.prototype.enable=function(){this.reset(),this.enabled=!0},H.prototype.keyevent=function(t,i){if("Enter"===t&&i&&(this.lock=!this.lock),this.enabled)switch(t){case"ArrowUp":this.arrowUp=i;break;case"ArrowDown":this.arrowDown=i;break;case"ArrowLeft":this.arrowLeft=i;break;case"ArrowRight":this.arrowRight=i;break;case"KeyW":this.keyW=i;break;case"KeyA":this.keyA=i;break;case"KeyS":this.keyS=i;break;case"KeyD":this.keyD=i;break;case"Numpad2":this.numpad2=i;break;case"Numpad4":this.numpad4=i;break;case"Numpad5":this.numpad5=i;break;case"Numpad6":this.numpad6=i;break;case"Numpad8":this.numpad8=i;break;case"Space":this.space=i}},H.prototype.forward=function(){return this.arrowUp||this.keyW||this.numpad8},H.prototype.backward=function(){return this.arrowDown||this.keyS||this.numpad2},H.prototype.left=function(){return this.arrowLeft||this.keyA||this.numpad4},H.prototype.right=function(){return this.arrowRight||this.keyD||this.numpad6},H.prototype.trigger=function(){return this.enabled&&this.lock||this.space||this.numpad5},W.SCROLL_START=100,W.SCROLL_RATE=16,W.prototype.hide=function(){this.help.style.visibility="hidden"},W.prototype.show=function(){this.help.style.visibility="visible"},W.prototype.scroll=function(t){let i=this.about.offsetParent.offsetHeight,e=this.about.offsetHeight,s=i-W.SCROLL_START,n=e+i,o=Math.min(n,t*W.SCROLL_RATE/1e3);this.about.style.marginTop=s-o+"px"},G.FONT="24pt 'League Spartan', sans-serif",G.ROWS=6,G.COLS=2,G.LINE_TOP=80,G.LINE_HEIGHT=36,G.COL1=-220,G.COL2=80,G.NUM_WIDTH=50,G.COLOR="#ddd",G.HIGHLIGHT="DarkOrange",G.prototype.setup=function(){this.place=-1,this.difficulty=null},G.prototype.reset=function(){localStorage.clear(),this.times.easy=[],this.times.medium=[],this.times.hard=[],this.setup()},G.prototype.read=function(t){let i=localStorage.getItem(`${this.name}.${t}`);return i?i.split(" ").map((t=>Number(t))):[]},G.prototype.write=function(t){let i=this.times[t].join(" ");localStorage.setItem(`${this.name}.${t}`,i)},G.prototype.insert=function(t,i){const e=G.COLS*G.ROWS;let s=this.times[i];this.place=s.findIndex((i=>t<i)),this.place>=0?(s.splice(this.place,0,t),this.times[i]=s.slice(0,e)):s.length<e&&(this.place=s.length,s.push(t)),this.place>=0&&(this.difficulty=i,this.write(i))},G.prototype.ordinal=function(){switch(this.place){case 0:return"New record!!";case 1:return"2nd best time!";case 2:return"3rd best time!";default:return this.place>2?`${this.place+1}th best time`:""}},G.prototype.draw=function(t,i){t.save(),t.textAlign="left";for(let e=0;e<G.ROWS;e++){let s=G.LINE_TOP-e*G.LINE_HEIGHT;this.drawLeader(t,i,e,G.COL1,s),this.drawLeader(t,i,e+G.ROWS,G.COL2,s)}t.restore()},G.prototype.drawLeader=function(t,i,e,s,n){let o=G.COLOR;i==this.difficulty&&e==this.place&&(o=G.HIGHLIGHT);let r="--m--.-s",h=this.times[i];e<h.length&&(r=D.format(h[e],!0)),T(s,n).write(t,G.FONT,e+1,0,o),T(s+G.NUM_WIDTH,n).write(t,G.FONT,r,0,o)},U.prototype.setup=function(t){"easy"==t?this.setupEasy():"hard"==t?this.setupHard():this.setupMedium()},U.prototype.setupEasy=function(){this.roidCount=4,this.roidSize=2,this.roidMin=320,this.roidVar=40,this.roidBaseHP=-2,this.shipThrust=24,this.shipDissipationMin=.018,this.shipDissipationVar=.012},U.prototype.setupMedium=function(){this.roidCount=6,this.roidSize=3,this.roidMin=380,this.roidVar=30,this.roidBaseHP=0,this.shipThrust=20,this.shipDissipationMin=.015,this.shipDissipationVar=.01},U.prototype.setupHard=function(){this.roidCount=9,this.roidSize=3,this.roidMin=370,this.roidVar=40,this.roidBaseHP=2,this.shipThrust=16,this.shipDissipationMin=.015,this.shipDissipationVar=.007};const j=2*Math.PI;function Y(t,i){this.ship=t,this.home=i,this.plan="",this.parked=!1}function Z(t,i){this.path=t.copy(),this.age=0,this.path.impulse(T.polar(Z.MUZZLE_VELOCITY,i));let e=this.path.speed();for(let t of Z.criticals)if(e>t.speed){this.color=t.color,this.life=t.life;let i=Math.floor(Math.random()*t.varhp);this.damage=t.minhp+i;break}}function q(t,i){this.pos=t.plus(T.fuzz(q.FUZZ)),this.radius=i,this.age=0,this.life=q.LIFE_MS}Y.TURN_RATE=Math.PI,Y.THRUST=12,Y.MIN_RADIUS=10,Y.FAR_MULTIPLIER=4,Y.FONT="20pt 'League Spartan', sans-serif",Y.COLOR="lime",Y.EPSILON_R=5,Y.EPSILON_E=.05,Y.prototype.tick=function(t,i){},Y.prototype.done=function(){let t=this.ship.pos(),i=this.ship.orbit;return Math.abs(t.len()-this.home)<Y.EPSILON_R&&i.e<Y.EPSILON_E},Y.prototype.advance=function(t){if(this.parked)this.steer(Math.PI/2,!1,t);else if(this.done())this.parked=!0,this.plan="parked";else{let i=this.ship.pos(),e=this.ship.orbit,s=i.dot(e.major),n=i.dot(e.minor);switch(this.plan=this.action(),this.plan){case"expand":this.aim(1,s>0,t);break;case"contract":s>0?this.aim(-1,!0,t):this.aim(1,n>0,t);break;case"start flip":this.aim(1,s<0&&n>0,t);break;case"build flip":this.aim(1,s<0,t);break;case"flip":this.aim(1,!0,t);break;case"recover":this.aim(-1,n<0,t);break;case"scramble":this.aim(-1,!0,t);break;case"yikes":this.aim(-1,s<0,t)}}},Y.prototype.action=function(){let t=this.ship.orbit,i=t.p/(1-t.e),e=t.p/(1+t.e);return i<this.home?e<Y.MIN_RADIUS?"scramble":"expand":t.h>0?e>this.home?"contract":e<Y.MIN_RADIUS?"scramble":"recover":i>this.home*Y.FAR_MULTIPLIER?e>this.home?"start flip":e<Y.MIN_RADIUS?"flip":"build flip":e<Y.MIN_RADIUS?t.p>this.home?"flip":"yikes":"expand"},Y.prototype.aim=function(t,i,e){let s=this.ship.orbit.minor.scale(t).theta();this.steer(s,i,e)},Y.prototype.steer=function(t,i,e){let s=t-this.ship.heading;s>Math.PI?s-=j:s<-Math.PI&&(s+=j);let n=Y.TURN_RATE*e;Math.abs(s)>n?this.ship.heading+=Math.sign(s)*n:(this.ship.heading=t,i&&this.ship.thrust(e*Y.THRUST))},Y.prototype.draw=function(t){T(0,-150).write(t,Y.FONT,this.plan,0,Y.COLOR);let i=this.ship.pos().len(),e=this.ship.orbit.e,s=`r = ${Math.floor(i)}, e = ${Math.floor(100*e)/100}`;T(0,-180).write(t,Y.FONT,s,0,Y.COLOR)},Z.MUZZLE_VELOCITY=200,Z.RADIUS=1.6,Z.criticals=[{speed:450,color:"cyan",life:2200,minhp:20,varhp:25},{speed:380,color:"yellow",life:1500,minhp:9,varhp:14},{speed:330,color:"red",life:1200,minhp:4,varhp:6},{speed:0,color:"white",life:1e3,minhp:1,varhp:0}],Z.prototype.alive=function(){return this.age<this.life},Z.prototype.position=function(){return this.path.position(this.age)},Z.prototype.advance=function(t,i=null){this.age+=t,i&&this.alive()&&i.push(this)},Z.prototype.hit=function(t){return this.alive()?(t.hit(),this.life=0,this.damage):0},Z.prototype.draw=function(t){this.alive()&&this.position().spot(t,Z.RADIUS,this.color)},q.LIFE_MS=2800,q.EXPANSION=4,q.FUZZ=3.5,q.prototype.alive=function(){return this.age<this.life},q.prototype.advance=function(t,i=null){this.age+=t,i&&this.alive()&&i.push(this)},q.prototype.draw=function(t){let i=this.radius+this.age*q.EXPANSION/1e3,e=.5*Math.max(0,1-this.age/this.life)**2;this.pos.spot(t,i,`rgb(192 192 192 / ${e})`)};const z=2*Math.PI;function K(){this.rate=0}K.RATE=z,K.RAMP=5*z,K.DECAY=2*z,K.prototype.turn=function(t){let i=t*K.RAMP,e=Math.min(this.rate+i,K.RATE),s=(this.rate+e)/2;return this.rate=e,t*s},K.prototype.decay=function(t){let i=t*K.DECAY;this.rate=Math.max(0,this.rate-i)};const $=2*Math.PI;function V(t,i,e,s=$/4){this.controls=i,this.mu=t.mu,this.accel=t.shipThrust,this.dissipationMin=t.shipDissipationMin,this.dissipationVar=t.shipDissipationVar,this.heading=s,this.left=new K,this.right=new K,this.deadturn=0,this.pilot=null,this.death="",this.color=V.LIVE_COLOR,this.heat=0,this.moved=!1,this.orbit=new S(this.mu,e)}V.LIVE_COLOR="lime",V.DEAD_COLOR="SlateGrey",V.SIZE=5,V.ABSORPTION=100,V.RETRO_FACTOR=.75,V.SPEED_CAP=.99,V.LOW_SIGNAL_LEVEL=1e3,V.CRASH_SLOWDOWN=10,V.THRUST_SMOKE=5,V.RETRO_SMOKE=2.5,V.OUTER_FLAME_COLOR="yellow",V.INNER_FLAME_COLOR="orange",V.FLAME_SIZE=10,V.RETRO_DISPLACEMENT=3,V.FORE_POS=4,V.AFT_POS=5,V.prototype.alive=function(){return this.controls.enabled},V.prototype.pos=function(){return this.orbit.path.pos},V.prototype.ahead=function(t=1){return T.polar(t,this.heading)},V.prototype.tick=function(t,i,e){if(this.alive()){if(this.controls.forward()){let t=this.pos().plus(this.ahead(-V.AFT_POS));e.push(new q(t,V.THRUST_SMOKE))}else if(this.controls.backward()&&t%2){let t=this.ahead(),i=this.pos().plus(t.scale(V.FORE_POS)),s=t.crossZ(V.RETRO_DISPLACEMENT);e.push(new q(i.plus(s),V.RETRO_SMOKE)),e.push(new q(i.minus(s),V.RETRO_SMOKE))}this.controls.trigger()&&i.push(new Z(this.orbit.path,this.heading))}else this.pilot&&this.pilot.tick(t,e)},V.prototype.advance=function(t){let i=t/1e3;this.alive()?(this.controls.left()?(this.heading+=this.left.turn(i),this.right.rate=0):this.left.decay(i),this.controls.right()?(this.heading-=this.right.turn(i),this.left.rate=0):this.right.decay(i),this.controls.forward()?this.thrust(i*this.accel):this.controls.backward()&&this.thrust(-i*this.accel*V.RETRO_FACTOR)):this.pilot?this.pilot.advance(i):this.heading+=this.deadturn*i;let e=V.ABSORPTION/this.pos().sqr(),s=this.dissipationMin+this.heat*this.dissipationVar,n=this.heat+i*(e-s);this.heat=Math.max(0,Math.min(2,n)),this.heading%=$,this.heading<0&&(this.heading+=$),this.orbit.advance(t)},V.prototype.fried=function(t,i){if(this.orbit.complete()&&this.near(t)){if(!this.alive())return!0;this.die("you crashed into the sun")}return!1},V.prototype.near=function(t){return this.pos().sqr()<(t+V.SIZE)**2},V.prototype.thrust=function(t){let i=this.orbit.path;i.impulse(this.ahead(t)),this.moved=!0,i.cap(Math.sqrt(2*this.mu/i.altitude())*V.SPEED_CAP),this.orbit=new S(this.mu,i)},V.prototype.crash=function(t){if(this.alive()){t.crash(),this.die("you crashed");let i=this.orbit.path;i.slow(V.CRASH_SLOWDOWN),this.orbit=new S(this.mu,i)}},V.prototype.die=function(t){this.death=t,this.moved=!1,this.controls.enabled=!1,this.color=V.DEAD_COLOR,this.deadturn=(.5-Math.random())*K.RATE},V.prototype.draw=function(t){let i=this.pos();if(!(i.sqr()>V.LOW_SIGNAL_LEVEL**2)){if((this.alive()||this.pilot)&&this.orbit.draw(t),t.save(),t.translate(i.x,i.y),t.rotate(this.heading),this.moved){let i=V.FLAME_SIZE*Math.random(),e=i+V.FLAME_SIZE*Math.random();this.controls.backward()?(this.drawRetro(t,-1,e/2,V.OUTER_FLAME_COLOR),this.drawRetro(t,-1,i/2,V.INNER_FLAME_COLOR),this.drawRetro(t,1,e/2,V.OUTER_FLAME_COLOR),this.drawRetro(t,1,i/2,V.INNER_FLAME_COLOR)):(this.drawThrust(t,e,V.OUTER_FLAME_COLOR),this.drawThrust(t,i,V.INNER_FLAME_COLOR)),this.moved=!1}t.fillStyle=this.color,t.beginPath(),t.moveTo(8,0),t.lineTo(6,2),t.lineTo(1,2),t.lineTo(-4,7),t.lineTo(-6,7),t.lineTo(-6,2),t.lineTo(-8,2),t.lineTo(-8,-2),t.lineTo(-6,-2),t.lineTo(-6,-7),t.lineTo(-4,-7),t.lineTo(1,-2),t.lineTo(6,-2),t.fill(),t.restore()}},V.prototype.drawThrust=function(t,i,e){t.fillStyle=e,t.beginPath(),t.moveTo(-6,2),t.lineTo(-6-i,0),t.lineTo(-6,-2),t.fill()},V.prototype.drawRetro=function(t,i,e,s){let n=i*V.RETRO_DISPLACEMENT;t.fillStyle=s,t.beginPath(),t.moveTo(-2,n-2),t.lineTo(e,n),t.lineTo(-2,n+2),t.fill()};const X=2*Math.PI;function Q(t,i,e){this.audio=e,this.effects=[],this.color=t.sunColor,this.radius=t.sunRadius,this.mu=t.mu,this.home=t.shipRadius,this.ship=new V(t,i,this.circle(this.home)),this.bullets=[],this.total=0,this.roids=[];for(let i=0;i<t.roidCount;i++)this.addRoid(t);this.popped=0}function J(){let t=document.getElementById("canvas");t.width=J.WIDTH,t.height=J.HEIGHT,this.ctx=t.getContext("2d"),this.ctx.translate(J.WIDTH/2,J.HEIGHT/2),this.ctx.scale(1,-1),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.head=T(0,J.TITLE_OFFSET),this.sub=T(0,J.CLOCK_OFFSET),this.foot=T(0,-J.TITLE_OFFSET),this.controls=new H,this.buttons=new F(this),this.title=!0,this.running=!1,this.replay=!1,this.win=!1,this.result=null,this.audio=new x,this.clock=new D,this.params=new U(this.difficulty()),this.world=new Q(this.params,this.controls,this.audio),this.leaders=new G,this.help=new W,this.progress=new B(0,"progress",J.PROGRESS_COLOR),this.heat=new B(1,"temperature",J.HEAT_COLOR),this.range=J.WIDTH**2+J.HEIGHT**2,addEventListener("keydown",(t=>this.hitkey(t))),addEventListener("click",(t=>this.click(t)))}Q.prototype.circle=function(t,i=0){let e=Math.sqrt(this.mu/t);return new O(T.polar(t,i),T.polar(e,i+Math.PI/2))},Q.prototype.addRoid=function(t){let i=t.roidMin+Math.random()*t.roidVar,e=this.circle(i,Math.random()*X);this.roids.push(new L(t,e,t.roidSize)),this.total+=2**(t.roidSize+1)-1},Q.prototype.completed=function(){return 0==this.roids.length},Q.prototype.park=function(){this.ship.pilot=new Y(this.ship,this.home)},Q.prototype.tick=function(t){this.ship&&this.ship.tick(t,this.bullets,this.effects)},Q.prototype.update=function(t){this.ship&&this.ship.advance(t);let i=[];this.bullets.forEach((e=>e.advance(t,i))),this.bullets=i;let e=[];this.roids.forEach((i=>i.advance(t,e))),this.roids=e;let s=[];this.effects.forEach((i=>i.advance(t,s))),this.effects=s,this.audio&&this.collisions()},Q.prototype.collisions=function(){let t=[];this.roids.forEach((i=>{let e=0;this.bullets.forEach((t=>{i.collide(t.position(),t.radius)&&(e+=t.hit(this.audio))})),this.popped+=i.smash(e,t,this.effects,this.audio)})),this.roids=t,this.ship&&this.checkShip()},Q.prototype.checkShip=function(){this.roids.forEach((t=>{t.collide(this.ship.pos(),V.SIZE)&&this.ship.crash(this.audio)})),this.ship.alive()&&this.ship.heat>=1&&this.ship.die("your ship overheated"),this.ship.fried(this.radius,this.audio)&&(this.ship=null)},Q.prototype.signal=function(){return this.ship?this.ship.pos().sqr():0},Q.prototype.shipHeat=function(){return this.ship?Math.min(1,this.ship.heat):0},Q.prototype.shipDeath=function(){return this.ship?this.ship.death:""},Q.prototype.progress=function(){return this.popped/this.total},Q.prototype.draw=function(t){this.ship&&this.ship.draw(t),this.bullets.forEach((i=>i.draw(t))),this.effects.forEach((i=>i.draw(t))),this.roids.forEach((i=>i.draw(t))),T().spot(t,this.radius,this.color)},J.WIDTH=1280,J.HEIGHT=720,J.TITLE_OFFSET=240,J.CLOCK_OFFSET=150,J.REPLAY_DELAY_MS=2e3,J.CLOCK_COLOR="DarkOrange",J.WIN_COLOR="#ccc",J.PROGRESS_COLOR="RoyalBlue",J.HEAT_COLOR="Crimson",J.WARNING_COLOR="Crimson",J.TITLE_TEXT="KEPLER'S BALLS",J.WIN_TEXT="YOU WIN!",J.LOSE_TEXT="GAME OVER",J.PLAY_TEXT="press any key to play",J.REPLAY_TEXT="press any key to play again",J.WARNING_TEXT="LOW SIGNAL WARNING",J.TITLE_FONT="80pt Philosopher, sans-serif",J.PLAY_FONT="28pt Philosopher, sans-serif",J.RESULT_FONT="60pt Philosopher, sans-serif",J.CLOCK_FONT="20pt 'League Spartan', sans-serif",J.WARNING_FONT="60pt 'League Spartan', sans-serif",J.prototype.difficulty=function(){return this.buttons.difficulty.value},J.prototype.hitkey=function(t){this.buttons.hideConfirm(),(this.title||this.replay)&&(this.audio.ctx||this.audio.setup(),this.help.hide(),this.buttons.startPlaying(),this.params.setup(this.difficulty()),this.world=new Q(this.params,this.controls,this.audio),this.title=!1,this.running=!0,this.replay=!1,this.result=null,this.leaders.setup(),this.controls.enable(),this.clock.start(),this.audio.startPlaying())},J.prototype.click=function(t){this.buttons.hideConfirm()},J.prototype.reload=function(){this.title=!0,this.running=!1,this.controls.enabled=!1,this.buttons.stopPlaying(),this.audio.stopMusic(),this.clock.start(),this.help.show()},J.prototype.run=function(){this.clock.frame(this.world),this.running&&(this.world.completed()?(this.audio.win(),this.win=!0,this.result=this.clock.finish(this.leaders,this.difficulty()),this.world.park(),this.finish()):this.controls.enabled?this.world.signal()>this.range&&(this.win=!1,this.result="ship lost",this.finish()):(this.win=!1,this.result=this.world.shipDeath(),this.finish())),this.draw(),requestAnimationFrame((()=>this.run()))},J.prototype.finish=function(){this.running=!1,this.controls.enabled=!1,this.audio.stopPlaying(),this.buttons.stopPlaying(),setTimeout((()=>{this.replay=!0}),J.REPLAY_DELAY_MS)},J.prototype.draw=function(){if(this.clear(),this.world.draw(this.ctx),this.title)this.head.write(this.ctx,J.TITLE_FONT,J.TITLE_TEXT),this.foot.write(this.ctx,J.PLAY_FONT,J.PLAY_TEXT),this.help.scroll(this.clock.time);else if(this.running){let t=this.clock.current;this.sub.write(this.ctx,J.CLOCK_FONT,t,0,J.CLOCK_COLOR),this.drawStatus(),this.world.signal()>this.range/4&&Date.now()%800<400&&T().write(this.ctx,J.WARNING_FONT,J.WARNING_TEXT,0,J.WARNING_COLOR)}else{this.win?this.head.write(this.ctx,J.RESULT_FONT,J.WIN_TEXT):this.head.write(this.ctx,J.RESULT_FONT,J.LOSE_TEXT);let t=this.result||`difficulty: ${this.difficulty()}`;this.sub.write(this.ctx,J.CLOCK_FONT,t,0,J.WIN_COLOR),this.drawStatus(),this.leaders.draw(this.ctx,this.difficulty()),this.replay&&this.foot.write(this.ctx,J.PLAY_FONT,J.REPLAY_TEXT)}},J.prototype.drawStatus=function(){this.progress.draw(this.ctx,this.world.progress()),this.heat.draw(this.ctx,this.world.shipHeat())},J.prototype.clear=function(){this.ctx.fillStyle="#000",this.ctx.fillRect(-J.WIDTH/2,-J.HEIGHT/2,J.WIDTH,J.HEIGHT)},(new J).run()})();
//# sourceMappingURL=bundle.js.map